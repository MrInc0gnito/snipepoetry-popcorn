<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>about:blank</title>

    <!-- Removing favicon -->
    <link rel="icon" href="about:blank">

    <style>
        /* Same styles as before */
    </style>
</head>
<body id="body">

    <!-- Video Background -->
    <video class="video-background" autoplay muted loop>
        <source src="https://github.com/MrInc0gnito/snipepoetry-popcorn/blob/main/854959-hd_1920_1080_30fps.mp4?raw=true" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <!-- Top Bar -->
    <div class="top-bar">
        <h1>Popcorn</h1>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="rounded-box">SnipeAds coming soon...</div>
        <div class="best-games">Best games</div>

        <!-- Game Tiles -->
        <div class="game-tiles">
            <div class="tile eaglercraft hidden" id="eaglercraft" onclick="openGameInIframe('https://math-lessons.vercel.app/test.html')">Eaglercraft</div>
            <div class="tile blockwave hidden" id="blockwave" onclick="openGameInIframe('https://github.com/MrInc0gnito/BlockWave-Gallery/blob/main/games.md')">BlockWave</div>
            <div class="tile radar-client hidden" id="radarclient" onclick="openGameInIframe('https://schoolsplus.vercel.app/website-data/prx-177/authbot-1/popcorn-security/nginxlocal.html')">Radar Client</div>
            <div class="tile audio-player hidden" id="audioPlayer" onclick="openGameInIframe('https://schoolsplus.vercel.app/website-data/prx-177/authbot-1/popcorn-security/websitecache.html')">Audio Player</div>
            <div class="tile snipe-uncensor hidden" id="snipeuncensor" onclick="openGameInIframe('https://snipeuncensor.yaha.buzz/')">SnipeUncensor</div>

            <!-- "Open Repo" button for all tiers -->
            <div class="tile repo" onclick="openGameInIframe('/repoimport.html')">Open Repo</div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <h1>Popcorn</h1>
        <p>Made with ‚ù§ by SnipeCo. üçÄ</p>
    </footer>

    <script>
        // Function to handle license key input
        function checkLicenseKey() {
            const key = prompt("License Key");

            const games = {
                "1x77": ["eaglercraft", "radarclient"],
                "theblockwavekey": ["blockwave"],
                "nitrosgamerguild": ["eaglercraft", "radarclient", "blockwave", "audioPlayer", "snipeuncensor"],
                "4x20@": ["eaglercraft"],  // Custom Tier 1.5 Key
                "guest": ["eaglercraft"]   // Custom Tier 1.5 Key
            };

            const selectedGames = games[key];

            if (selectedGames) {
                selectedGames.forEach(game => {
                    document.getElementById(game).classList.remove('hidden');
                });
            } else {
                alert("Invalid license key.");
                window.location.href = "about:blank"; // Redirect to about:blank if invalid
            }
        }

        // Function to open the game in a new about:blank page with iframe
        function openGameInIframe(url) {
            const newWindow = window.open("about:blank", "_blank");
            const iframe = newWindow.document.createElement('iframe');
            iframe.src = url;
            iframe.style.width = "100%";
            iframe.style.height = "100%";
            iframe.style.border = "none";
            newWindow.document.body.appendChild(iframe);

            // Add keyboard input enablement for iframe
            const script = newWindow.document.createElement('script');
            script.innerHTML = `
                function handleMouseDown(evt) {
                    window.focus();   
                    evt.preventDefault();  
                    evt.stopPropagation();  
                    evt.target.style.cursor = 'default';  
                }  
                document.getElementById('body').addEventListener('mousedown', handleMouseDown, false);
            `;
            newWindow.document.body.appendChild(script);

            // Replace the current page with /ms.html
            window.location.replace("/ms.html");
        }

        // Function to check the last page was /netv.html
        function checkReferrer() {
            const referrer = document.referrer;
            return referrer.includes("/netv.html");
        }

        // Function to check if user is on Chrome
        function isChrome() {
            const userAgent = navigator.userAgent.toLowerCase();
            return userAgent.indexOf('chrome') > -1 && userAgent.indexOf('edge') === -1;
        }

        // Run the checks on page load
        window.onload = function() {
            if (!checkReferrer()) {
                alert("You must visit /netv.html first.");
                window.location.href = "about:blank";
            }

            checkLicenseKey();

            if (!isChrome()) {
                alert("This page can only be viewed on Chrome.");
                window.location.href = "about:blank";
            }
        };
    </script>
</body>
</html>
